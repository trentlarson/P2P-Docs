<html>
<head>

<style>

.blurb {
  cursor: pointer;
  height: 30px; /* same as the hover contraction */
}
</style>

<script type="text/javascript" src="js/jquery-1.4.2.min.js"></script>
<script type="text/ruby"       src="ruby/search.rb"></script>

<script type="text/javascript" src="js/jquery.hoverIntent.r6.js"></script>

<script type="text/javascript" src="js/wz_jsgraphics.js"></script>
<script type="text/javascript" src="js/jquery.rotate.1-1.js"></script>
<script type="text/javascript" src="js/pieMenu.js"></script>
<link rel="stylesheet" type="text/css" href="css/pieMenu.css">

<script type="text/ruby">
  window.searcher = Search.new
</script>

<script>
var Ti = {fs: Titanium.Filesystem, api:Titanium.API};

$(document).ready(function() {
  try {
    //alert('resource dir ' + Ti.fs.getApplicationDataDirectory());
    //alert('resource dir ' + Ti.fs.getApplicationDataDirectory());
    //alert("sep " + Ti.fs.getSeparator());
    //var f = Titanium.Filesystem.getFile('/Users/tlarson/.p2pevents.info');
    //alert('exists? ' + f.exists());

    var dir = Titanium.Filesystem.getFile('/Users/tlarson/backed/doc/family-histories');
    var files = dir.getDirectoryListing();
    var moreInfo;
    files.forEach(function(filename) {
//      $("#files").append("<li>" + filename + "</li>");
    });
    moreInfo = window.searcher.main("/Users/tlarson/backed/doc/family-histories/JeanGould.html", "dog");
    moreInfo.forEach(function(resultInfo) {
      $("#files").append("<div class='blurb'><a href='locate.html?..." + resultInfo.file + "'>" + resultInfo.line + "</a> <span class='action'>(action)</span></div>");
    });
  } catch (e) {
    alert('error: ' + e);
  }
});

$(document).ready(function() {

  $(".blurb").each(function() {
    $(this).hoverIntent(
      function() { $(this).animate({'height':'60px'}); },
      function() { $(this).animate({'height':'30px'}); } // same as the initial CSS setting
    );
  });

  var config = {
    outerRadius: 120,
    innerRadius: 20,
    lineColor: '#969696',
    selectedColor: '#A7A7A7',
    textColor: '#000000',
    items: [
      { title: "Item 1", trigger: function() { alert('This is Item 1.'); }},
      { title: "Item 2",
        items: [
          { title: "Item 2a", trigger: function() { alert('This is Item 2a.'); }},
          { title: "Item 2b", trigger: function() { alert('This is Item 2b.'); }}
        ]
      },
    ]
  };

  $(".action").each(function() {
    $(this).click(function(e) {
      menu = new pieMenu(config);
      menu.show(e.pageX, e.pageY);
      return false;
    });
  });

});

</script>


</head>
<body style="background-color:#ffffff">
  <div style="padding:10px">Welcome to Titanium!</div>
  <div>
    <form action="search.html">
      <input type="text" name="term" />
      <input type="submit" />
    </form>
  </div>
  <div id="files"></div>
</body>
</html>
